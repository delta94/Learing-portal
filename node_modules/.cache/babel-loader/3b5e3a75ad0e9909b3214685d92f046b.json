{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ninew/Documents/GitHub/Learing-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ninew/Documents/GitHub/Learing-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import{push}from'connected-react-router';import{setCookie}from'cookie/cookie';var LOAD_LOGIN_REQUEST=\"learning-portal/src/login/LOAD_LOGIN_REQUEST\";var LOAD_LOGIN_SUCCESS=\"learning-portal/src/login/LOAD_LOGIN_SUCCESS\";var LOAD_LOGIN_FAILURE=\"learning-portal/src/login/LOAD_LOGIN_FAILURE\";var CLEAR_MESSAGE_LOGIN=\"learning-portal/src/login/CLEAR_MESSAGE_LOGIN\";function clearMessageLogin(){return{type:CLEAR_MESSAGE_LOGIN};}function loadLogin(userInfo){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:LOAD_LOGIN_REQUEST});_context.prev=1;_context.next=4;return axios.post(\"/Tokens\",userInfo);case 4:result=_context.sent;dispatch({type:LOAD_LOGIN_SUCCESS,payload:{user:result.data,status:result.status,messageLogin:null}});setCookie('id',userInfo.userId,3);setCookie('role',userInfo.role,3);setCookie('token',result.data.token,3);dispatch(push('/learning-portal'));_context.next=17;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](1);if(_context.t0.response.status===401){dispatch({type:LOAD_LOGIN_FAILURE,payload:{status:_context.t0.response.status,messageLogin:\"\\u0E23\\u0E2B\\u0E31\\u0E2A\\u0E1C\\u0E48\\u0E32\\u0E19\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07\"}});}if(_context.t0.response.status===404){dispatch({type:LOAD_LOGIN_FAILURE,payload:{status:_context.t0.response.status,messageLogin:\"\\u0E23\\u0E2B\\u0E31\\u0E2A\\u0E1C\\u0E39\\u0E49\\u0E43\\u0E0A\\u0E49\\u0E1C\\u0E34\\u0E14\"}});}if(_context.t0.response.status===500){dispatch({type:LOAD_LOGIN_FAILURE,payload:{status:_context.t0.response.status,messageLogin:\"\\u0E40\\u0E01\\u0E34\\u0E14\\u0E1B\\u0E31\\u0E0D\\u0E2B\\u0E32\\u0E17\\u0E32\\u0E07 server \".concat(_context.t0.response.status)}});}case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,12]]);}));return function(_x){return _ref.apply(this,arguments);};}();}export{LOAD_LOGIN_REQUEST,LOAD_LOGIN_SUCCESS,LOAD_LOGIN_FAILURE,CLEAR_MESSAGE_LOGIN,loadLogin,clearMessageLogin};","map":{"version":3,"sources":["/Users/ninew/Documents/GitHub/Learing-portal/src/modules/loginPortal/actions.tsx"],"names":["axios","push","setCookie","LOAD_LOGIN_REQUEST","LOAD_LOGIN_SUCCESS","LOAD_LOGIN_FAILURE","CLEAR_MESSAGE_LOGIN","clearMessageLogin","type","loadLogin","userInfo","dispatch","post","result","payload","user","data","status","messageLogin","userId","role","token","response"],"mappings":"mUAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,IAAT,KAAqB,wBAArB,CACA,OAASC,SAAT,KAA0B,eAA1B,CACA,GAAMC,CAAAA,kBAAkB,CAAG,8CAA3B,CACA,GAAMC,CAAAA,kBAAkB,CAAG,8CAA3B,CACA,GAAMC,CAAAA,kBAAkB,CAAG,8CAA3B,CACA,GAAMC,CAAAA,mBAAmB,CAAG,+CAA5B,CAIA,QAASC,CAAAA,iBAAT,EAA6B,CAC3B,MAAO,CACLC,IAAI,CAAEF,mBADD,CAAP,CAGD,CACD,QAASG,CAAAA,SAAT,CAAmBC,QAAnB,CAAkC,CAChC,+FAAO,iBAAOC,QAAP,6HACLA,QAAQ,CAAC,CAAEH,IAAI,CAAEL,kBAAR,CAAD,CAAR,CADK,sCAGkBH,CAAAA,KAAK,CAACY,IAAN,WAAsBF,QAAtB,CAHlB,QAGGG,MAHH,eAIHF,QAAQ,CAAC,CACPH,IAAI,CAAEJ,kBADC,CAEPU,OAAO,CAAE,CACPC,IAAI,CAAEF,MAAM,CAACG,IADN,CAEPC,MAAM,CAAEJ,MAAM,CAACI,MAFR,CAGPC,YAAY,CAAE,IAHP,CAFF,CAAD,CAAR,CAQAhB,SAAS,CAAC,IAAD,CAAOQ,QAAQ,CAACS,MAAhB,CAAwB,CAAxB,CAAT,CACAjB,SAAS,CAAC,MAAD,CAASQ,QAAQ,CAACU,IAAlB,CAAwB,CAAxB,CAAT,CACAlB,SAAS,CAAC,OAAD,CAAUW,MAAM,CAACG,IAAP,CAAYK,KAAtB,CAA6B,CAA7B,CAAT,CAEAV,QAAQ,CAACV,IAAI,CAAC,kBAAD,CAAL,CAAR,CAhBG,iFAoBH,GAAI,YAAIqB,QAAJ,CAAaL,MAAb,GAAwB,GAA5B,CAAiC,CAC/BN,QAAQ,CAAC,CACPH,IAAI,CAAEH,kBADC,CAEPS,OAAO,CAAE,CACPG,MAAM,CAAE,YAAIK,QAAJ,CAAaL,MADd,CAEPC,YAAY,+GAFL,CAFF,CAAD,CAAR,CAQD,CACD,GAAI,YAAII,QAAJ,CAAaL,MAAb,GAAwB,GAA5B,CAAiC,CAC/BN,QAAQ,CAAC,CACPH,IAAI,CAAEH,kBADC,CAEPS,OAAO,CAAE,CACPG,MAAM,CAAE,YAAIK,QAAJ,CAAaL,MADd,CAEPC,YAAY,iFAFL,CAFF,CAAD,CAAR,CAQD,CACD,GAAI,YAAII,QAAJ,CAAaL,MAAb,GAAwB,GAA5B,CAAiC,CAC/BN,QAAQ,CAAC,CACPH,IAAI,CAAEH,kBADC,CAEPS,OAAO,CAAE,CACPG,MAAM,CAAE,YAAIK,QAAJ,CAAaL,MADd,CAEPC,YAAY,2FAAyB,YAAII,QAAJ,CAAaL,MAAtC,CAFL,CAFF,CAAD,CAAR,CAQD,CAjDE,qEAAP,+DAqDD,CAID,OACEd,kBADF,CAEEC,kBAFF,CAGEC,kBAHF,CAIEC,mBAJF,CAKEG,SALF,CAMEF,iBANF","sourcesContent":["import axios from \"axios\";\nimport { push } from 'connected-react-router'\nimport { setCookie } from 'cookie/cookie'\nconst LOAD_LOGIN_REQUEST = \"learning-portal/src/login/LOAD_LOGIN_REQUEST\";\nconst LOAD_LOGIN_SUCCESS = \"learning-portal/src/login/LOAD_LOGIN_SUCCESS\";\nconst LOAD_LOGIN_FAILURE = \"learning-portal/src/login/LOAD_LOGIN_FAILURE\";\nconst CLEAR_MESSAGE_LOGIN = \"learning-portal/src/login/CLEAR_MESSAGE_LOGIN\";\n\n\n\nfunction clearMessageLogin() {\n  return {\n    type: CLEAR_MESSAGE_LOGIN,\n  }\n}\nfunction loadLogin(userInfo: any) {\n  return async (dispatch: any) => {\n    dispatch({ type: LOAD_LOGIN_REQUEST });\n    try {\n      const result = await axios.post(`/Tokens`, userInfo);\n      dispatch({\n        type: LOAD_LOGIN_SUCCESS,\n        payload: {\n          user: result.data,\n          status: result.status,\n          messageLogin: null\n        },\n      });\n      setCookie('id', userInfo.userId, 3)\n      setCookie('role', userInfo.role, 3)\n      setCookie('token', result.data.token, 3)\n\n      dispatch(push('/learning-portal'))\n\n\n    } catch (err) {\n      if (err.response.status === 401) {\n        dispatch({\n          type: LOAD_LOGIN_FAILURE,\n          payload: {\n            status: err.response.status,\n            messageLogin: `รหัสผ่านไม่ถูกต้อง`\n          },\n        });\n\n      }\n      if (err.response.status === 404) {\n        dispatch({\n          type: LOAD_LOGIN_FAILURE,\n          payload: {\n            status: err.response.status,\n            messageLogin: `รหัสผู้ใช้ผิด`\n          },\n        });\n\n      }\n      if (err.response.status === 500) {\n        dispatch({\n          type: LOAD_LOGIN_FAILURE,\n          payload: {\n            status: err.response.status,\n            messageLogin: `เกิดปัญหาทาง server ${err.response.status}`\n          },\n        });\n\n      }\n\n    }\n  };\n}\n\n\n\nexport {\n  LOAD_LOGIN_REQUEST,\n  LOAD_LOGIN_SUCCESS,\n  LOAD_LOGIN_FAILURE,\n  CLEAR_MESSAGE_LOGIN,\n  loadLogin,\n  clearMessageLogin\n\n};\n"]},"metadata":{},"sourceType":"module"}